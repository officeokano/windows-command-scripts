# Windows command scripts

  Windows のコマンドスクリプト（バッチファイル）です。手打ちでも構わないような1行から数行のスクリプトですが、入力の省力化とタイプミス防止のために使っています。

## su.cmd

  スクリプト集の中心になるものです。 cmd.exe を管理者モードで実行するにはスタートメニューから右クリックとか、いくつか方法がありますが、 unix 系 OS の su のようにコマンドラインから簡単に権限昇格できるものが欲しくて作りました。

## sudo.cmd

  su があるなら sudo も、ということで作っていますが、カレントディレクトリにあるコマンドスクリプト専用です。

## chkadmin.cmd

  スクリプトが管理者権限で実行されているかどうかを確認するためのものです。管理者権限でなければエラーメッセージを表示してエラーコード1を返し、管理者権限なら何もせずエラーコード0を返します。

  他のスクリプトの先頭に

    call chkadmin.cmd
    if %errorlevel% == 0 goto :main
    exit /b
    :main

  と記述する事で管理者権限の確認ができます。

## stopwindowsupdate.cmd

  Windows10 で windows update を一時的に停止するためのコマンドです。バックグラウンドでアップデートされると邪魔になるメンテナンス作業の前に実行します。管理者モードでの実行が必須です。

  Winodows 8.1 以前の OS では最後の行でエラーが出ます。エラーを無視すればそのまま使えます。

  再起動すると windows update は復活するので戻し忘れの心配はありません。

## resetwindowsupdate.cmd

  Windows update がうまく作動しなくなった時に動作をリセットするためのコマンドをまとめたものです。管理者モードでの実行が必須です。

## initnetwork.cmd

  ネットワーク接続がおかしくなった時にあれこれリセットするコマンドをまとめたものです。実際にはトラブルシューティングメニューから実行することが多く自分でもほとんど使っていません。

## removedavcache.cmd

  Webdav のキャッシュを削除するコマンドです。管理者モードでの実行が必須です。削除が成功したことを確認するために削除後のディレクトリエントリを表示します。
